(this.webpackJsonptp_es2=this.webpackJsonptp_es2||[]).push([[0],{35:function(e,t,a){e.exports=a(74)},40:function(e,t,a){},58:function(e,t,a){e.exports=a.p+"static/media/logo.ad33e832.png"},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAApuSURBVHhe7d2tblxnFIZRs8BcQmEuITDQsJdQaBgYWBZoWBhYGBgYGBgYGFhYaNruwww+z5lfPVW1lrSp0atHGs+ZmTsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADg/+/V3K9zv899mfs693Hut7nXc3ArtgcQeTv3Y+6fF+6vufs5uDbbA4h8mFuFd3Wf5rZXa3ANtgcQeTe3iu2h2/5FK8RcyvYAIltIf86tQrt3QswlbA8g9DC3CuyxJ8Scy/YAQo9zq7ieckLMOWwPILR91GoV1lNPiDmV7QGEvs+tonrOCTGnsD2A0PaxqlVQzz0h5li2BxB6P7eK6SUnxBzD9gBCb+ae5lYxveSEmD22BxA75ZvYTjkhZo/tAcS+za1CeukJMXtsDyC0/draNZ/Kfn5CzCG2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxATYiq2BxC7dYjhJbYHELtliB/m4CW2BxC7VYif5n6Zg5fYHkDsViF+nINDbA8gdosQf52DPbYHELt2iP+eg2PYHkDs09wqqOfc9l4sHMv2ACLXDPB22ys6OIbtAUSuHeDttr8Je2wPIHKLAG93PweH2B5A5FYB9gqMPbYHELlVgH/ObU91w0tsDyByywD7FjYOsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AiABTsT2AyOPcKqCXngCzx/YAIu/mVgG99ASYPbYHEHk1t8VyFdFLToDZY3sAoYe5VUQvOQHmGLYHEPpjbhXSc0+AOZbtAYS+z61ies4JMKewPYDQFs5VUE89AeZUtgcQ+nNuFdVTToA5h+0BhN7PrcJ67Akw57I9gNCbuae5VWD3ToC5hO0BxD7MrSJ76ASYa7A9gNi3uVVsVyfAXJPtAYS2b2X7OLeK7vPbfrTl9Rxci+0B/Ae8nduezn7+Ge0fc5/n7ufgVmwPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgGu7u/sXPn2NIxLVL1MAAAAASUVORK5CYII="},71:function(e,t,a){e.exports=a.p+"static/media/reached.bb6a439d.png"},72:function(e,t,a){},74:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),s=a(30),o=a.n(s),r=a(5),A=a(6),l=a(8),c=a(7),u=a(3),d=a(31),m=a(1),T=(a(40),a(2)),p=a.n(T),h="PKjmwpad10e91Bh2JUD7GcjLdM-j9B4PhW3eWUnr8sA",B=function(e){Object(l.a)(i,e);var t=Object(c.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e)).state={username:"",password:"",error:!1,logginIn:!1},a.changeLoginData=a.changeLoginData.bind(Object(m.a)(a)),a.submitLoginForm=a.submitLoginForm.bind(Object(m.a)(a)),a}return Object(A.a)(i,[{key:"componentDidMount",value:function(){localStorage.removeItem("jwt-token")}},{key:"changeLoginData",value:function(e){this.setState(Object(d.a)({},e.target.name,e.target.value))}},{key:"submitLoginForm",value:function(e){var t=this;e.preventDefault(),this.setState({logginIn:!0});var a={username:this.state.username,password:this.state.password},i={method:"POST",data:a};p()("https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/login",i).then((function(e){var a=e.data;localStorage.setItem("jwt-token",a.token),t.props.history.push("/home")})).catch((function(e){401===e.response.status?t.setState({error:!0,logginIn:!1}):alert("[ERRO] Algo de errado n\xe3o est\xe1 certo")}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"login-container"},this.state.logginIn?n.a.createElement("div",{className:"loading-spin-container"},n.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}),n.a.createElement("p",null,"Loggin in...")):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"logo-container"},n.a.createElement("img",{className:"mb-4",alt:"logo",src:a(58)})),n.a.createElement("div",{className:"login-form-container"},n.a.createElement("div",{className:"login-text-container"},n.a.createElement("h1",{align:"center"},"Login")),n.a.createElement("form",{className:"form-signin",onSubmit:this.submitLoginForm},n.a.createElement("div",{className:"login-form-fields-container"},n.a.createElement("div",{className:"login-fields-container"},n.a.createElement("input",{type:"text",id:"username",name:"username",placeholder:"Username",maxLength:"150",required:!0,autoFocus:!0,onChange:this.changeLoginData})),n.a.createElement("div",{className:"login-fields-container"},n.a.createElement("input",{type:"password",id:"password",name:"password",placeholder:"Password",maxLength:"15",onChange:this.changeLoginData,required:!0})),n.a.createElement("div",{className:"invalid-login-message",style:{display:this.state.error?"block":"none"}},n.a.createElement("h4",{align:"center"},"Invalid Credentials")),n.a.createElement("div",{className:"login-button-container"},n.a.createElement("input",{type:"submit",className:"login-button",value:"Login"})))))))}}]),i}(i.Component),v=Object(u.f)(B),g=a(34),f=(a(64),a(33)),E=a.n(f),x=function(){return localStorage.getItem("jwt-token")},b=a(16),Y=a.n(b),q=new E.a({bitRate:128}),k=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={isRecording:!1,blobURL:"",JWT:x(),isBlocked:!1,isLoading:!1},i.askForMicrophonePermission=i.askForMicrophonePermission.bind(Object(m.a)(i)),i.micStartRecording=i.micStartRecording.bind(Object(m.a)(i)),i.micStopRecording=i.micStopRecording.bind(Object(m.a)(i)),i.microphoneHandler=i.microphoneHandler.bind(Object(m.a)(i)),i.blobToBase64=i.blobToBase64.bind(Object(m.a)(i)),i.sendFileToServer=i.sendFileToServer.bind(Object(m.a)(i)),i}return Object(A.a)(a,[{key:"askForMicrophonePermission",value:function(){var e=this;navigator.getUserMedia({audio:!0},(function(){e.setState({isBlocked:!1})}),(function(){e.setState({isBlocked:!0})}))}},{key:"micStartRecording",value:function(){var e=this;q.start().then((function(){e.setState({isRecording:!0})})).catch((function(e){return console.error(e)})),document.getElementById("microButton").style.backgroundColor="green"}},{key:"micStopRecording",value:function(){var e=this;q.stop().getMp3().then((function(t){var a=Object(g.a)(t,2),i=(a[0],a[1]);document.getElementById("microButton").style.backgroundColor="red";var n=URL.createObjectURL(i);e.setState({blobURL:n,isRecording:!1}),e.blobToBase64(i)})).catch((function(e){return alert("[ERRO] Erro durante a grava\xe7\xe3o do \xe1udio. Tente novamente")}))}},{key:"microphoneHandler",value:function(){this.askForMicrophonePermission(),this.state.isBlocked?alert("[ERRO] N\xe3o existe permiss\xe3o para usar o microfone"):!1===this.state.isRecording?this.micStartRecording():this.micStopRecording()}},{key:"blobToBase64",value:function(e){var t=this,a=new FileReader;a.readAsDataURL(e),a.onloadend=function(){t.sendFileToServer(a.result)}}},{key:"sendFileToServer",value:function(e){var t=this;this.setState({isLoading:!0});var a={method:"POST",headers:{Authorization:this.state.JWT},data:e};p()("https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/audiofile",a).then((function(e){var a=e.data.transcriptionRequest+".json";t.props.history.push({pathname:"/loading",state:{fileName:a}})})).catch((function(e){403===e.response.status?(alert("[ERRO] Token de Sess\xe3o \xe9 inv\xe1lido ou expirou. Redirecionando para a p\xe1gina de Login"),t.props.history.push("/")):(window.location.reload(!1),alert("[ERRO] Algo de errado n\xe3o est\xe1 certo!"))}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"home-container"},this.state.isLoading?n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{style:{color:"#2c2d2d"}},"A processar o seu pedido"),n.a.createElement(Y.a,{type:"bubbles",color:"#2c2d2d",id:"waitingDots"})):n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"Use o microfone para indicar o seu destino pretendido"),n.a.createElement("h1",null,"Para onde ?"),n.a.createElement("div",{id:"microButton",onClick:this.microphoneHandler},n.a.createElement("i",{className:"fa fa-microphone"}))),this.state.isRecording?n.a.createElement(Y.a,{type:"bars",color:"#737070"}):null)}}]),a}(i.Component),y=Object(u.f)(k),O=(a(65),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={fileName:i.props.location.state.fileName,JWT:x()},i.componentCleanup=i.componentCleanup.bind(Object(m.a)(i)),i.tick=i.tick.bind(Object(m.a)(i)),i}return Object(A.a)(a,[{key:"componentCleanup",value:function(){clearInterval(this.interval)}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",this.componentCleanup),this.interval=setInterval((function(){return e.tick()}),5e3)}},{key:"componentWillUnmount",value:function(){this.componentCleanup(),window.removeEventListener("beforeunload",this.componentCleanup)}},{key:"tick",value:function(){var e=this,t={method:"GET",params:{fileName:this.state.fileName},headers:{Authorization:this.state.JWT}};p()("https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/transcription",t).then((function(t){var a=t.data.transcription;e.props.history.push({pathname:"/transcription",state:{location:a}})})).catch((function(t){var a=t.response.status;403===a?(alert("[ERRO] Token de Sess\xe3o \xe9 inv\xe1lido ou expirou. Redirecionando para a p\xe1gina de Login"),e.props.history.push("/")):410===a&&(alert("[ERRO] Audio submetido n\xe3o p\xf4de ser transcrito. Tente novamente"),e.props.history.push("/home"))}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"loading-container"},n.a.createElement("h1",{style:{color:"#2c2d2d"}},"A processar o seu pedido"),n.a.createElement(Y.a,{type:"bubbles",color:"#2c2d2d",id:"waitingDots"}))}}]),a}(i.Component)),C=Object(u.f)(O),N=(a(66),{sourceAddress:"",sourceLatitude:0,sourceLongitude:0,destinationAddress:"",destinationLatitude:0,destinationLongitude:0,travelDistance:"",price:0,estimatedTravelTime:0,driverTotalDistance:0,driverInitialLatitude:0,driverInitialLongitude:0}),j=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={JWT:x(),destinations:[],desiredLocation:i.props.location.state.location,isFetching:!0,taxiStation:{},totalDistance:0},i.getNearestTaxiStation=i.getNearestTaxiStation.bind(Object(m.a)(i)),i.getAddressByCoordinates=i.getAddressByCoordinates.bind(Object(m.a)(i)),i.getDistanceBetweenTwoLocations=i.getDistanceBetweenTwoLocations.bind(Object(m.a)(i)),i}return Object(A.a)(a,[{key:"isGeoLocationSupported",value:function(){return!!navigator.geolocation||(alert("[ERRO] O seu browser n\xe3o suporta geolocaliza\xe7\xe3o"),this.props.history.push("/home"),!1)}},{key:"onClickHandler",value:function(e){var t=this;if(this.isGeoLocationSupported()){navigator.geolocation.getCurrentPosition((function(a){N.sourceLatitude=a.coords.latitude,N.sourceLongitude=a.coords.longitude,N.destinationLatitude=t.state.destinations[e].position.lat,N.destinationLongitude=t.state.destinations[e].position.lng,N.destinationAddress=t.state.destinations[e].title,t.getNearestTaxiStation()}))}}},{key:"getNearestTaxiStation",value:function(){var e=this,t="https://discover.search.hereapi.com/v1/discover?at="+N.sourceLatitude+","+N.sourceLongitude+"&q=taxis&limit=20&apiKey= "+h;p()(t,{method:"GET"}).then((function(t){N.driverInitialLatitude=t.data.items[0].position.lat,N.driverInitialLongitude=t.data.items[0].position.lng,e.setState({taxiStation:t.data.items[0]});for(var a=1;a<t.data.items.length;a++)t.data.items[a].distance<e.state.taxiStation.distance&&e.setState({taxiStation:t.data.items[a]});e.setState({totalDistance:e.state.taxiStation.distance}),e.getDistanceBetweenTwoLocations()})).catch((function(){alert("[ERRO] N\xe3o foi poss\xedvel localizar a esta\xe7\xe3o de taxis mais perto de si")}))}},{key:"getDistanceBetweenTwoLocations",value:function(){var e=this,t="https://router.hereapi.com/v8/routes?transportMode=car&origin="+N.sourceLatitude+","+N.sourceLongitude+"&destination="+N.destinationLatitude+","+N.destinationLongitude+"&apikey="+h+"&return=travelSummary";p()(t,{method:"GET"}).then((function(t){N.travelDistance=t.data.routes[0].sections[0].travelSummary.length,N.estimatedTravelTime=t.data.routes[0].sections[0].travelSummary.duration,N.driverTotalDistance=e.state.totalDistance,N.price=Math.round(N.driverTotalDistance/1e3*10)/10,e.setState({totalDistance:e.state.totalDistance+N.travelDistance}),e.getAddressByCoordinates()})).catch((function(){alert("[ERRO] N\xe3o foi poss\xedvel calcular um itener\xe1rio para o seu destino pretendido")}))}},{key:"getAddressByCoordinates",value:function(){var e=this,t="https://reverse.geocoder.ls.hereapi.com/6.2/reversegeocode.json?prox="+N.sourceLatitude+","+N.sourceLongitude+",250&mode=retrieveAddresses&maxresults=1&gen=9&apiKey="+h;p()(t,{method:"GET"}).then((function(t){N.sourceAddress=t.data.Response.View[0].Result[0].Location.Address.Label,e.props.history.push({pathname:"/confirmTrip",state:{travel:N}})})).catch((function(){alert("[ERRO] N\xe3o foi poss\xedvel localizar o endere\xe7o atrav\xe9s das suas coordenadas")}))}},{key:"componentDidMount",value:function(){var e=this,t="https://geocode.search.hereapi.com/v1/geocode?q="+this.state.desiredLocation+"&apiKey="+h;p()(t,{method:"GET"}).then((function(t){e.setState({destinations:t.data.items,isFetching:!1})})).catch((function(){alert("[ERRO] N\xe3o foi poss\xedvel localizar nenhum destino correspondente \xe0 sua procura")}))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"destinations-container"},this.state.isFetching?n.a.createElement("div",{className:"loading-spin-container"},n.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}),n.a.createElement("p",null,"Localizando o seu local...")):this.state.destinations.length?n.a.createElement("ul",{className:"destinations-list-options"},n.a.createElement("h4",null,"Escolha o seu destino:"),this.state.destinations.map((function(t,a){return[n.a.createElement("div",{key:a,className:"destinations-option-container",onClick:function(){return e.onClickHandler(a)}},n.a.createElement("p",null,n.a.createElement("b",null,t.title.split(",")[0])),n.a.createElement("p",null,t.title.split(",")[1]),n.a.createElement("p",null,t.title.split(",")[2]))]}))):n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"N\xe3o foi poss\xedvel identificar um local"),n.a.createElement("button",{id:"button",onClick:function(){return e.props.history.push("/transcription")}},"Tentar de Novo")))}}]),a}(i.Component),L=Object(u.f)(j),S=(a(67),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={location:"",JWT:x()},i.buttonClickHandler=i.buttonClickHandler.bind(Object(m.a)(i)),i.iconClickHandler=i.iconClickHandler.bind(Object(m.a)(i)),i}return Object(A.a)(a,[{key:"componentDidMount",value:function(){try{this.setState({location:this.props.location.state.location.replace(".","")})}catch(e){console.warn(e)}}},{key:"buttonClickHandler",value:function(){this.props.history.push("/home")}},{key:"iconClickHandler",value:function(){this.props.history.push({pathname:"/results",state:{location:document.querySelector("input").value}})}},{key:"render",value:function(){return n.a.createElement("div",{className:"transcription-container"},""!==this.state.location?n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",null,"Foi isto que pronunciou ?"),n.a.createElement("p",null,"Caso n\xe3o, pode editar o texto em baixo ou volte atr\xe1s para tentar de novo com o microfone")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",null,"N\xe3o foi poss\xedvel perceber o seu texto de voz!"),n.a.createElement("p",null,"Pesquise em baixo ou volte atr\xe1s para tentar de novo com o microfone")),n.a.createElement("div",{className:"search-container"},n.a.createElement("input",{defaultValue:this.state.location}),n.a.createElement("i",{onClick:this.iconClickHandler,className:"fa fa-search"})),n.a.createElement("div",{className:"button transcription",onClick:this.buttonClickHandler},"Voltar"))}}]),a}(i.Component)),P=Object(u.f)(S),w=(a(68),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={jwt:x(),travel:i.props.location.state.travel,driver:{},isFetching:!0},i.confirmHandleOnClick=i.confirmHandleOnClick.bind(Object(m.a)(i)),i.declineHandleOnClick=i.declineHandleOnClick.bind(Object(m.a)(i)),i}return Object(A.a)(a,[{key:"componentDidMount",value:function(){var e=this;p()({method:"get",url:"https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/taxidriver",headers:{Authorization:this.state.jwt}}).then((function(t){e.setState({driver:t.data}),e.setState({isFetching:!1})})).catch((function(t){403===t.response.status?(alert("Token de Sess\xe3o \xe9 inv\xe1lido ou expirou. Redirecionando para a p\xe1gina de Login"),e.props.history.push("/")):(window.location.reload(!1),alert("[ERRO] Algo de errado n\xe3o est\xe1 certo!"))}))}},{key:"confirmHandleOnClick",value:function(){this.props.history.push({pathname:"/trackTrip",state:{travel:this.state.travel,driver:this.state.driver}})}},{key:"declineHandleOnClick",value:function(){this.props.history.push({pathname:"/home"})}},{key:"render",value:function(){return n.a.createElement("div",{className:"travel-container"},this.state.isFetching?n.a.createElement("div",{className:"loading-spin-container"},n.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}),n.a.createElement("p",null,"Localizando o seu local...")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"Confirmar viagem ?"),n.a.createElement("div",{className:"tripInfo-container"},n.a.createElement("p",null,n.a.createElement("b",null,"Origem: ")," ",this.state.travel.sourceAddress),n.a.createElement("p",null,n.a.createElement("b",null,"Destino: ")," ",this.state.travel.destinationAddress),n.a.createElement("p",null,n.a.createElement("b",null,"Condutor: ")," ",this.state.driver.name),n.a.createElement("p",null,n.a.createElement("b",null,"Ve\xedculo: ")," ",this.state.driver.car),n.a.createElement("p",null,n.a.createElement("b",null,"Matricula: ")," ",this.state.driver.plate),n.a.createElement("p",null,n.a.createElement("b",null,"Classifica\xe7\xe3o Condutor: ")," ",this.state.driver.evaluation+"/5"),n.a.createElement("p",null,n.a.createElement("b",null,"Pre\xe7o: ")," ",this.state.travel.price+"\u20ac"),n.a.createElement("p",null,n.a.createElement("b",null,"Tempo Estimado de Viagem: ")," ",new Date(1e3*this.state.travel.estimatedTravelTime).toISOString().substr(11,8)),n.a.createElement("p",null,n.a.createElement("b",null,"Distancia: ")," ",Math.round(this.state.travel.travelDistance/1e3*10)/10+" km")),n.a.createElement("div",{className:"buttons-container"},n.a.createElement("div",{className:"button confirm",onClick:this.confirmHandleOnClick,style:{marginRight:"10px"}},"Confirmar"),n.a.createElement("div",{className:"button decline",onClick:this.declineHandleOnClick},"Cancelar"))))}}]),a}(i.Component)),R=Object(u.f)(w),F=(a(69),function(e){Object(l.a)(i,e);var t=Object(c.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e)).state={jwt:x(),travel:a.props.location.state.travel,driver:a.props.location.state.driver,isFetching:!0,travelPoints:{},tripFile:"",currentTravelPoints:{}},a.componentCleanup=a.componentCleanup.bind(Object(m.a)(a)),a.tick=a.tick.bind(Object(m.a)(a)),a.handleOnClick=a.handleOnClick.bind(Object(m.a)(a)),a}return Object(A.a)(i,[{key:"componentCleanup",value:function(){clearInterval(this.interval)}},{key:"componentDidMount",value:function(){var e=this,t=[],a=[];window.addEventListener("beforeunload",this.componentCleanup),p()({method:"get",url:"https://router.hereapi.com/v8/routes?transportMode=car&origin="+this.state.travel.driverInitialLatitude+","+this.state.travel.driverInitialLongitude+"&destination="+this.state.travel.sourceLatitude+","+this.state.travel.sourceLongitude+"&apikey=PKjmwpad10e91Bh2JUD7GcjLdM-j9B4PhW3eWUnr8sA&return=polyline&spans=names"}).then((function(i){for(var n=0;n<i.data.routes[0].sections[0].spans.length;n++)void 0!==i.data.routes[0].sections[0].spans[n].names&&t.push(i.data.routes[0].sections[0].spans[n].names[0].value);p()({method:"get",url:"https://router.hereapi.com/v8/routes?transportMode=car&origin="+e.state.travel.sourceLatitude+","+e.state.travel.sourceLongitude+"&destination="+e.state.travel.destinationLatitude+","+e.state.travel.destinationLongitude+"&apikey=PKjmwpad10e91Bh2JUD7GcjLdM-j9B4PhW3eWUnr8sA&return=polyline&spans=names"}).then((function(i){for(var n=0;n<i.data.routes[0].sections[0].spans.length;n++)void 0!==i.data.routes[0].sections[0].spans[n].names&&a.push(i.data.routes[0].sections[0].spans[n].names[0].value);var s={taxiTripPoints:t,clientTripPoints:a,checkedTaxiTripPoints:[],checkedClientTripPoints:[]};e.setState({travelPoints:s}),p()({method:"POST",url:"https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/starttrip",headers:{Authorization:e.state.jwt},data:e.state.travelPoints}).then((function(t){e.setState({tripFile:t.data.tripInfoFile}),p()({method:"get",url:"https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/tripdetails",params:{fileName:e.state.tripFile},headers:{Authorization:e.state.jwt}}).then((function(t){e.setState({currentTravelPoints:t.data}),e.setState({isFetching:!1}),e.interval=setInterval((function(){return e.tick()}),1500)})).catch((function(t){var a=t.response.status;403===a?(alert("[ERRO] Token de Sess\xe3o \xe9 inv\xe1lido ou expirou. Redirecionando para a p\xe1gina de Login"),e.props.history.push("/")):(400===a||404===a)&&(alert("[ERRO] Ficheiro com a rota n\xe3o existe. Tente novamente"),e.props.history.push("/home"))}))}))}))}))}},{key:"componentWillUnmount",value:function(){this.componentCleanup(),window.removeEventListener("beforeunload",this.componentCleanup)}},{key:"tick",value:function(){var e=this;p()({method:"get",url:"https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/tripdetails",params:{fileName:this.state.tripFile},headers:{Authorization:this.state.jwt}}).then((function(t){e.setState({currentTravelPoints:t.data}),0===e.state.currentTravelPoints.taxiTripPoints.length&&0===e.state.currentTravelPoints.clientTripPoints.length&&e.componentCleanup()})).catch((function(t){e.componentCleanup();var a=t.response.status;403===a?(alert("[ERRO] Token de Sess\xe3o \xe9 inv\xe1lido ou expirou. Redirecionando para a p\xe1gina de Login"),e.props.history.push("/")):404===a&&(alert("[ERRO] Ficheiro com a rota n\xe3o existe. Tente novamente"),e.props.history.push("/home"))}))}},{key:"handleOnClick",value:function(){console.log(this.state.driver.name),this.props.history.push({pathname:"/evaluation",state:{destination:this.state.travel.destinationAddress,driver:this.state.driver.name}})}},{key:"render",value:function(){return n.a.createElement("div",{className:"travel-container"},this.state.isFetching?n.a.createElement("div",{className:"loading-spin-container"},n.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}),n.a.createElement("p",null,"Chamando o seu taxista...")):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"Trip-Detais-Container"},0!==this.state.currentTravelPoints.taxiTripPoints.length||0!==this.state.currentTravelPoints.clientTripPoints.length?n.a.createElement(n.a.Fragment,null,0!==this.state.currentTravelPoints.taxiTripPoints.length?n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"Taxi a caminho")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"Em viagem at\xe9 ao seu destino")),n.a.createElement("div",{className:"Trip-Points-Container"},0!==this.state.currentTravelPoints.taxiTripPoints.length?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"Taxi-Trip-Points-Container"},n.a.createElement("ul",{className:"Taxi-Trip-Points-List"},this.state.currentTravelPoints.taxiTripPoints.map((function(e,t){return[n.a.createElement("div",{key:t,className:"Trip-Point-Container"},n.a.createElement("p",null,e))]}))))):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"Client-Trip-Points-Container"},n.a.createElement("ul",{className:"Client-Trip-Points-List"},this.state.currentTravelPoints.clientTripPoints.map((function(e,t){return[n.a.createElement("div",{key:t,className:"Trip-Point-Container"},n.a.createElement("p",null,e))]}))))),n.a.createElement("div",{className:"Direction-Points-Container"},n.a.createElement("img",{className:"mb-4",alt:"directionArrow",src:a(70)})),n.a.createElement("div",{className:"Checked-Points-Container"},n.a.createElement("ul",{className:"Checked-Trip-Points-List"},0!==this.state.currentTravelPoints.taxiTripPoints.length?n.a.createElement(n.a.Fragment,null,this.state.currentTravelPoints.checkedTaxiTripPoints.map((function(e,t){return[n.a.createElement("div",{key:t,className:"Trip-Point-Container"},n.a.createElement("p",null,e))]}))):n.a.createElement(n.a.Fragment,null,this.state.currentTravelPoints.checkedClientTripPoints.map((function(e,t){return[n.a.createElement("div",{key:t,className:"Trip-Point-Container"},n.a.createElement("p",null,e))]}))))))):n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"Chegou ao seu destino"),n.a.createElement("div",{className:"Destiny-Trip-Container"},n.a.createElement("img",{className:"mb-4",alt:"reached",src:a(71)})),n.a.createElement("div",{className:"button-Evaluation",onClick:this.handleOnClick},"Avaliar Viagem")))))}}]),i}(i.Component)),D=Object(u.f)(F),z=(a(72),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={JWT:x(),isFetching:!1,destination:i.props.location.state.destination,driver:i.props.location.state.driver,rating:0,requestSuccess:!1},i.handleOnClick=i.handleOnClick.bind(Object(m.a)(i)),i}return Object(A.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.querySelectorAll(".input-star").forEach((function(t){t.addEventListener("click",(function(a){e.setState({rating:t.value})}))}))}},{key:"handleOnClick",value:function(){var e=this;console.log(this.state.destination),p()({method:"POST",url:"https://cgytidzzce.execute-api.us-east-1.amazonaws.com/taxiApp/evaluation",headers:{Authorization:this.state.JWT},data:{rating:this.state.rating,destination:this.state.destination,driver:this.state.driver}}).then((function(t){e.setState({requestSuccess:!0})})).catch((function(t){403===t.response.status?(alert("Token de Sess\xe3o \xe9 inv\xe1lido ou expirou. Redirecionando para a p\xe1gina de Login"),e.props.history.push("/")):(window.location.reload(!1),alert("[ERRO] Algo de errado n\xe3o est\xe1 certo!"))}))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"evaluation-container"},this.state.requestSuccess?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"evaluation-submited-container"},n.a.createElement("h1",null,"Obrigado !"),n.a.createElement("p",null,"A sua avalia\xe7\xe3o foi registada: "),n.a.createElement("p",null,n.a.createElement("b",null,"Avalia\xe7\xe3o: "),this.state.rating,"/5"),n.a.createElement("p",null,n.a.createElement("b",null,"Condutor: "),this.state.driver),n.a.createElement("p",null,n.a.createElement("b",null,"Destino: "),this.state.destination)),n.a.createElement("div",{className:"button-submit",onClick:function(){return e.props.history.push("/home")}},"P\xe1gina Inicial")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"Avalie o servi\xe7o"),n.a.createElement("div",{className:"stars-container"},n.a.createElement("fieldset",{className:"rating"},n.a.createElement("input",{className:"input-star",type:"radio",id:"star5",name:"rating",value:"5"}),n.a.createElement("label",{className:"full",htmlFor:"star5",title:"Fant\xe1stico - 5 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star4half",name:"rating",value:"4.5"}),n.a.createElement("label",{className:"half",htmlFor:"star4half",title:"Muito bom - 4.5 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star4",name:"rating",value:"4"}),n.a.createElement("label",{className:"full",htmlFor:"star4",title:"Muito bom - 4 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star3half",name:"rating",value:"3.5"}),n.a.createElement("label",{className:"half",htmlFor:"star3half",title:"Meh - 3.5 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star3",name:"rating",value:"3"}),n.a.createElement("label",{className:"full",htmlFor:"star3",title:"Meh - 3 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star2half",name:"rating",value:"2.5"}),n.a.createElement("label",{className:"half",htmlFor:"star2half",title:"Ligeiramente mau - 2.5 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star2",name:"rating",value:"2"}),n.a.createElement("label",{className:"full",htmlFor:"star2",title:"Ligeiramente mau - 2 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star1half",name:"rating",value:"1.5"}),n.a.createElement("label",{className:"half",htmlFor:"star1half",title:"Mau - 1.5 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"star1",name:"rating",value:"1"}),n.a.createElement("label",{className:"full",htmlFor:"star1",title:"Terr\xedvel - 1 estrelas"}),n.a.createElement("input",{className:"input-star",type:"radio",id:"starhalf",name:"rating",value:"0.5"}),n.a.createElement("label",{className:"half",htmlFor:"starhalf",title:"Este chefe devia ser preso - 0.5 estrelas"}))),n.a.createElement("div",{className:"button-submit",onClick:this.handleOnClick},"Submeter")))}}]),a}(i.Component)),I=Object(u.f)(z),H=(a(73),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(A.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"background"},n.a.createElement(u.c,null,n.a.createElement(u.a,{exact:!0,path:"/",component:v}),n.a.createElement(u.a,{path:"/home",component:y}),n.a.createElement(u.a,{path:"/loading",component:C}),n.a.createElement(u.a,{path:"/results",component:L}),n.a.createElement(u.a,{path:"/transcription",component:P}),n.a.createElement(u.a,{path:"/confirmTrip",component:R}),n.a.createElement(u.a,{path:"/trackTrip",component:D}),n.a.createElement(u.a,{path:"/evaluation",component:I})))}}]),a}(i.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var M=a(13);o.a.render(n.a.createElement(M.a,null,n.a.createElement(H,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.81dacdd7.chunk.js.map